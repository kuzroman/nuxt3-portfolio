var xe=Object.defineProperty;var Se=(t,e,s)=>e in t?xe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var m=(t,e,s)=>(Se(t,typeof e!="symbol"?e+"":e,s),s),oe=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var H=(t,e,s)=>(oe(t,e,"read from private field"),s?s.call(t):e.get(t)),ie=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)},re=(t,e,s,n)=>(oe(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s);import{r as l,j as Le,k as f,w as C,o as h,a as p,t as S,l as U,u as g,m as be,e as r,p as Q,q as Z,C as Y,s as ee,F as we,b as $e,c as ce,v as Be,f as G,x as te,y as se,h as y,z as he,A as Ge,B as Ie,D as _e,E as J,G as ke,H as Me}from"./entry.efc01a27.js";const De={key:1},Re={__name:"LetterTag",props:{sign:{type:String,default:" "},isKilled:{type:Boolean,default:!1},isShow:{type:Boolean,default:!1}},emits:["letter-tag--show"],setup(t,{emit:e}){const s=t,n=l(null),i=l(null),o=l(null),c=l(null),d=l(null),_=l(Le().vnode.key),L=f(()=>[{show:s.isShow},{hide:s.isKilled}]),w=()=>{if(!n.value)return;let x=n.value.getBoundingClientRect();i.value=Math.ceil(x.left),c.value=Math.ceil(x.top),o.value=Math.ceil(x.left+n.value.clientWidth),d.value=Math.ceil(x.top+n.value.clientHeight)};return C(()=>s.isShow,()=>{w(),e("letter-tag--show",{x1:i.value,x2:o.value,y1:c.value,y2:d.value,id:_.value})}),(x,$)=>t.sign!=="|"?(h(),p("div",{key:0,class:U(["letter-tag",g(L)]),ref_key:"letterEl",ref:n},S(t.sign),3)):(h(),p("br",De))}};const Ce={class:"debug-input"},Fe={class:"left"},Ue={class:"right"},ze={__name:"DebugInput",props:{isDebug:{type:Boolean,default:!1},seeds:{type:Array,default:[]},bullets:{type:Array,default:[]},letters:{type:Array,default:[]},shooter:{type:Object,default:{}}},emits:["debug-input--pause"],setup(t,{emit:e}){const s=t,n=l(!1),i=o=>{const c=o||"Space";document.body.addEventListener("keydown",d=>{d.code===c&&(n.value=!n.value,e("debug-input--pause",n.value))}),document.body.focus()};return be(()=>{console.log(s.isDebug),s.isDebug&&i("Space")}),(o,c)=>(h(),p("div",Ce,[r("pre",Fe,S([...t.seeds,...t.bullets]),1),r("pre",Ue,S(t.letters),1)]))}};var k;class Te{constructor(e){ie(this,k,void 0);m(this,"ctx");re(this,k,document.querySelector(e)),this.ctx=H(this,k).getContext("2d")}drawRect(e,s,n,i){this.ctx.fillStyle=i||"#fff",this.ctx.fillRect(e,s,n,n)}drawRing(e,s,n,i){this.ctx.beginPath(),this.ctx.arc(e,s,n,0,2*Math.PI),this.ctx.fillStyle=i,this.ctx.fill()}clearCanvas(e=H(this.ctx,k).width,s=H(this.ctx,k).height){this.ctx.clearRect(0,0,e,s)}}k=new WeakMap;const F=(t,e)=>Math.floor(Math.random()*(e-t+1)+t);class Pe{constructor(e,s,n="default"){m(this,"ground",document.body.offsetHeight);m(this,"gravityX",F(1,5));m(this,"gravityY",F(1,5));m(this,"speed",F(2,5)/10);m(this,"bounceNum",0);m(this,"maxBounceNum",5);m(this,"revert",!1);this.x1=e||0,this.y1=s||0,this.size=F(1,3),this.isStopped=!1,this.direction=Math.random()<.6?1:-1,this.type=n}update(e){this.type==="shrapnel"?this._updateShrapnel():this._updateSeed(e)}_updateSeed(e){if(this._isBarrier(e)&&(this.revert=!0,this.bounceNum+=1),this.gravityY<0&&(this.revert=!1),this._isBounceLimitReached()||this._isUnderGround()){this.isStopped=!0;return}this._move()}_updateShrapnel(){if(this._isUnderGround()){this.isStopped=!0;return}this._fallDown(this.direction,!0)}_isBounceLimitReached(){return this.maxBounceNum<this.bounceNum}_isUnderGround(){return this.ground<this.y1}_isBarrier(e){return e?this.y1>=e.y1&&e.x1<this.x1&&this.x1<e.x2:!1}_move(){this.revert?this._fallUp():this._fallDown()}_fallDown(e,s){this._moveX(e,s),this.y1+=Math.round(this.gravityY),this.gravityY=Math.round((this.gravityY+this.speed)*100)/100}_fallUp(e){this._moveX(e),this.y1-=Math.round(this.gravityY),this.gravityY=Math.round((this.gravityY-1)*100)/100}_moveX(e=1,s=!1){const n=s?F(2,8):7;this.x1+=e*Math.round(this.gravityX/n),this.gravityX=Math.round((this.gravityX+this.speed)*100)/100}}class He{constructor(e,s){m(this,"gravityY",10);m(this,"ground",-20);this.x1=e,this.x2=e+6,this.y1=s,this.size=6,this.isStopped=!1}update(){if(this._isOverScreen()){this.isStopped=!0;return}this._move()}_move(){this._moveY()}_moveY(){this.y1-=Math.round(this.gravityY)}_isOverScreen(){return this.y1<this.ground}}class le{constructor(e,s){m(this,"isShow",!1);m(this,"x1",0);m(this,"x2",0);m(this,"y1",0);m(this,"y2",0);const n=e===" "||e==="|";this.id=s,this.sign=e===" "?"-":e,this.isKilled=n,this.isService=n}static getLifeLetters(e){return e.filter(s=>!s.isKilled)}}const Ye=""+new URL("explode.1718f901.mp3",import.meta.url).href;const Oe={class:"canvas-letters"},Ae={class:"letters",id:"lettersEl"},Ee=["width","height"],Ne={__name:"CanvasLetters",props:{isDebug:{type:Boolean,default:!1},barrier:{type:Object,default:null},shooter:{type:Object,default:()=>{}}},emits:["canvas-letters-damage"],setup(t,{emit:e}){const s=t,n=Q();let i,o,c;const d=l([]),_=l([]),L=l(3),w=l(16),x=l(!1),$=l(null),M=l(0),D=l(0),A=f(()=>n.getters["app/isPageLoaderHide"]),E=f(()=>n.getters["game/shots"]),b=f(()=>n.getters["game/letters"]),N=f(()=>s.isDebug?"Hello":"Hello, my name is Roman.|I am a Front-End developer with 12 years experience.|SPA, SSR, SSG, js and Vue ... are my passion.|Check this out some projects on my Work page.|Feel free if you wanna say hello at kuzroman@list.ru then do it!)"),z=a=>n.commit("game/setIsSeedsFall",a),V=a=>n.commit("game/setIsGameFinished",a),K=a=>n.commit("game/setLetters",a),B=a=>n.commit("game/updateLetters",a),I=a=>n.commit("game/showLetter",a),R=a=>n.commit("game/killLetter",a);C(()=>A.value,()=>{ne()}),C(()=>E.value,()=>{let a=new He(s.shooter.x1,s.shooter.y1);_.value.push(a),ae()});const X=()=>{const a=Array.from(N.value,(u,v)=>new le(u,v));K(a)},j=()=>{let a=0,u;o=setInterval(()=>{a<=b.value.length-1?(u=b.value[a],I(u),B(u)):clearInterval(o),a++},w.value)},W=a=>{let u=b.value[a.id];B({...u,...a}),T(a)},T=(a,u)=>{for(let v=0;v<L.value;v++){let q=new Pe(a.x1,a.y1,u);d.value.push(q)}},ae=()=>{z(!0),clearInterval(c),c=setInterval(()=>{x.value||($.value.clearCanvas(M.value,D.value),pe(),ve(),!d.value.length&&!_.value.length&&(clearInterval(c),z(!1)))},w.value)},pe=()=>{d.value=d.value.filter(a=>(a.update(s.barrier),a.type==="shrapnel"&&fe(s.shooter,a),$.value.drawRect(a.x1,a.y1,a.size),!a.isStopped))},ve=()=>{_.value=_.value.filter(a=>{a.update();let u=le.getLifeLetters(b.value);return u.length?ge(a,u):V(!0),$.value.drawRing(a.x1,a.y1,a.size,"#fc0"),!a.isStopped})},ge=(a,u)=>{u.forEach(v=>{a.y1<v.y1&&(a.x1<v.x1&&v.x1<a.x2||a.x1<v.x2&&v.x2<a.x2||v.x1<a.x1&&a.x2<v.x2)&&(R(v),T({x1:a.x1,y1:a.y1},"shrapnel"),i.replay())})},fe=(a,u)=>{a.y1<u.y1&&a.x1<u.x1&&u.x1<a.x2&&(u.isStopped=!0,e("canvas-letters-damage"))},ye=a=>{x.value=a},ne=()=>{$.value=new Te("#canvas"),X(),j(),ae()};return Z(()=>{M.value=window.innerWidth,D.value=window.innerHeight,i=new Y(Ye,.3),ne()}),ee(()=>{clearInterval(o),i.destroy()}),(a,u)=>{const v=Re,q=ze;return h(),p("div",Oe,[r("div",Ae,[(h(!0),p(we,null,$e(g(b),P=>(h(),ce(v,{key:P.id,isShow:P.isShow,isKilled:P.isKilled,sign:P.sign,"onLetterTag-Show":W},null,8,["isShow","isKilled","sign"]))),128))]),r("canvas",{id:"canvas",width:g(M),height:g(D)},null,8,Ee),t.isDebug?(h(),ce(q,{key:0,isDebug:t.isDebug,seeds:g(d),bullets:g(_),letters:g(b),shooter:t.shooter,"onDebugInput-Pause":ye},null,8,["isDebug","seeds","bullets","letters","shooter"])):Be("",!0)])}}};const Ve={name:"UIButton",props:{text:{type:String,default:"Button"},disabled:{type:Boolean,default:!1}},data(){return{}},computed:{},methods:{}},Ke={class:"ui-button"};function Xe(t,e,s,n,i,o){return h(),p("div",Ke,S(s.text),1)}const O=G(Ve,[["render",Xe]]);const je={name:"ButtonPlay",components:{UIButton:O},props:{},data(){return{barrier:{},texts:{default:"Destroy this text",wait:"Wait for falling ...",again:"Play again"}}},computed:{...te("game",["isSeedsFall","isGameReady","isGameFinished"]),text(){return this.isGameFinished?this.texts.again:this.isSeedsFall?this.texts.wait:this.texts.default},disabled(){return this.isSeedsFall},stiles(){return{disabled:this.disabled,hide:this.isGameReady&&!this.isGameFinished}}},methods:{...se("game",["setIsGameReady"]),handleClick(){if(!this.isSeedsFall){if(this.isGameFinished){this.$emit("button-play--restart",this.barrier);return}setTimeout(()=>{this.setIsGameReady(!0)})}},createBarrier(){let t=this.$el.getBoundingClientRect();this.barrier={x1:t.left,x2:t.left+t.width,y1:t.top}}},mounted(){this.createBarrier(),this.$emit("button-play--mounted",this.barrier)}},We=["disabled"];function qe(t,e,s,n,i,o){const c=O;return h(),p("div",{class:U(["button-play",o.stiles]),onClick:e[0]||(e[0]=(...d)=>o.handleClick&&o.handleClick(...d)),disabled:o.disabled},[y(c,{text:o.text},null,8,["text"])],10,We)}const Je=G(je,[["render",qe]]);const Qe={name:"UILoaderLine",props:{percent:{type:Number,default:50}},data(){return{}},computed:{width(){return`${this.percent}%`}}},Ze={class:"ui-loader-line"};function et(t,e,s,n,i,o){return h(),p("div",Ze,[r("div",{class:"loader",style:he({width:o.width})},null,4)])}const me=G(Qe,[["render",et]]);const tt={name:"IconTime"},st={class:"icon-time",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 50 50",space:"preserve"},at=r("path",{d:"M7.533,21.646C9.111,13.06,16.633,6.552,25.678,6.552c10.188,0,18.447,8.259,18.447,18.448 c0,10.19-8.259,18.447-18.447,18.447c-7.167,0-13.378-4.084-16.433-10.053h3.886c2.708,4.039,7.317,6.699,12.547,6.699 c8.336,0,15.094-6.758,15.094-15.094S34.014,9.907,25.678,9.907c-7.184,0-13.195,5.018-14.72,11.739H7.533L7.533,21.646z M24.838,25.587l8.74,5.151l0.851-1.444l-7.913-4.706V13.314h-1.678V25.587z M8.906,28.354l5.031-6.708H3.875L8.906,28.354z M7.533,21.646C9.111,13.06,16.633,6.552,25.678,6.552c10.188,0,18.447,8.259,18.447,18.448c0,10.19-8.259,18.447-18.447,18.447 c-7.167,0-13.378-4.084-16.433-10.053h3.886c2.708,4.039,7.317,6.699,12.547,6.699c8.336,0,15.094-6.758,15.094-15.094 S34.014,9.907,25.678,9.907c-7.184,0-13.195,5.018-14.72,11.739H7.533L7.533,21.646z M24.838,25.587l8.74,5.151l0.851-1.444 l-7.913-4.706V13.314h-1.678V25.587z M8.906,28.354l5.031-6.708H3.875L8.906,28.354z",fill:"#6a6a6a"},null,-1),nt=[at];function ot(t,e,s,n,i,o){return h(),p("svg",st,nt)}const it=G(tt,[["render",ot]]);const rt={name:"IconShield"},ct=t=>(Ge("data-v-c9eb4c77"),t=t(),Ie(),t),lt={class:"icon-shield",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 50 50",space:"preserve"},dt=ct(()=>r("path",{d:"M41.575,12.596c-3.887-1.112-6.776-2.975-9.326-4.616C29.669,6.317,27.442,4.882,25,4.882 c-2.441,0-4.668,1.435-7.248,3.094c-2.549,1.645-5.438,3.507-9.325,4.619l-1.324,0.378v1.376c0,0.691,0.033,5.652,0.086,6.479 c0.109,1.667,0.339,3.317,0.684,4.905c3.292,15.173,15.951,20.082,16.488,20.282L25,46.256l0.642-0.24 c0.536-0.2,13.193-5.105,16.486-20.282c0.345-1.588,0.575-3.237,0.684-4.905c0.055-0.825,0.086-5.787,0.086-6.479v-1.376 L41.575,12.596z M25,44.308V25.345H9.658C9.343,23.9,9.119,22.358,9.012,20.71c-0.049-0.75-0.084-5.567-0.084-6.36 C16.964,12.051,21.067,6.709,25,6.709V20.71v4.635h15.346C37.226,39.73,25,44.308,25,44.308z",fill:"#6a6a6a"},null,-1)),ut=[dt];function ht(t,e,s,n,i,o){return h(),p("svg",lt,ut)}const _t=G(rt,[["render",ht],["__scopeId","data-v-c9eb4c77"]]);const de=100;let ue;const mt={name:"StatusBar",components:{UI_Loader_line:me,UILink2Move:_e,IconTime:it,IconShield:_t},data(){return{health:de,isDebug:!1}},watch:{isGameStart(){this.runTimer()},damage(t){this.health=de-t},health(t){t<=0&&this.setIsGameFinished(!0)}},computed:{...te("game",["isGameReady","isGameStart","isGameFinished","score","shots","letters","killedLetters","damage","timeLeft"])},methods:{...se("game",["setIsGameFinished","setIsLeaderBoardOpened","setScore","decreaseTimeLeft"]),runTimer(){ue=setInterval(()=>{this.decreaseTimeLeft(),(this.timeLeft<=0||this.isGameFinished)&&(this.setIsGameFinished(!0),clearInterval(ue))},1e3)},openLeaderBoard(){this.setIsLeaderBoardOpened(!0)}}},pt={class:"status-bar--top"},vt={class:"score"},gt={class:"status-bar--right"},ft={class:"time"};function yt(t,e,s,n,i,o){const c=J("IconTime"),d=J("IconShield"),_=me,L=_e;return h(),p("div",{class:U(["status-bar",{active:t.isGameReady||i.isDebug}])},[r("div",pt,[r("div",vt,S(t.killedLetters.length)+" killed",1),r("div",gt,[y(c),y(d),r("div",ft,S(t.timeLeft)+"s",1)])]),y(_,{class:"loader-Line",percent:i.health},null,8,["percent"]),y(L,{class:"leaders",text:"leaderboard",onClick:o.openLeaderBoard},null,8,["onClick"])],2)}const xt=G(mt,[["render",yt]]),St=""+new URL("damage.f1e615a0.mp3",import.meta.url).href;const Lt={__name:"RobotShooter",props:{position:{type:Object,default:{}}},setup(t,{expose:e}){const s=t,n=Q();let i;const o=l(!1),c=l(null),d=f(()=>n.getters["game/isGameReady"]),_=f(()=>n.getters["game/isGameFinished"]),L=f(()=>n.getters["game/damage"]),w=f(()=>({left:s.position.x1+"px"})),x=f(()=>({active:d.value&&!_.value,damage:o.value})),$=()=>{o.value=!0,setTimeout(()=>{o.value=!1},300)};return C(()=>L.value,()=>{$(),i.replay()}),Z(()=>{i=new Y(St,.3)}),ee(()=>{i.destroy()}),e({shooter:c}),(M,D)=>(h(),p("div",{class:U(["robot-shooter",g(x)]),style:he(g(w)),ref_key:"shooter",ref:c},null,6))}};const bt={},wt={class:"ui-dashed-list"};function $t(t,e,s,n,i,o){return h(),p("div",wt,[ke(t.$slots,"default")])}const Bt=G(bt,[["render",$t]]);const Gt={name:"ScoreBoard",components:{UIButton:O,DashedList:Bt},data(){return{isDebug:!1}},watch:{score(t){this.setScore(t)}},computed:{...te("game",["isGameFinished","timeLeft","damage","shots","letters","killedLetters","aliveLetters","score"]),score(){if(this.aliveLetters.length,!this.killedLetters.length)return 0;const t=Math.ceil(this.killedLetters.length*1e4/(this.aliveLetters.length+this.shots)),e=this.timeLeft*10-this.damage*5;return t+e}},methods:{...se("game",["setScore","setIsLeaderBoardOpened"]),openLeaderBoard(){this.setIsLeaderBoardOpened(!0)}}},It=r("div",{class:"hooray"},"Hooray!",-1),kt={class:"result"},Mt=r("div",null,"Time left",-1),Dt={class:"result"},Rt=r("div",null,"Shots",-1),Ct={class:"result"},Ft=r("div",null,"Goals",-1),Ut={class:"result"},zt=r("div",null,"Life",-1),Tt={class:"result best"},Pt=r("div",null,"Your best score",-1);function Ht(t,e,s,n,i,o){const c=J("DashedList"),d=O;return h(),p("div",{class:U(["score-board",{active:t.isGameFinished||i.isDebug}])},[r("h3",null,S(o.score)+" points",1),It,y(c,null,{default:Me(()=>[r("div",kt,[Mt,r("div",null,S(t.timeLeft),1)]),r("div",Dt,[Rt,r("div",null,S(t.shots),1)]),r("div",Ct,[Ft,r("div",null,S(t.killedLetters.length),1)]),r("div",Ut,[zt,r("div",null,S(100-t.damage),1)]),r("div",Tt,[Pt,r("div",null,S(o.score),1)])]),_:1}),y(d,{text:"show leaderboard",class:"btn-leaderboard",onClick:o.openLeaderBoard},null,8,["onClick"])],2)}const Yt=G(Gt,[["render",Ht]]),Ot=""+new URL("shoot.6b00b3bd.mp3",import.meta.url).href,At=""+new URL("backgroundGame.c17ea688.mp3",import.meta.url).href;const Et={__name:"MainGame",setup(t){const e=Q();let s,n;const i=l(null),o=l(!1),c=l({}),d=l(0),_=l(null),L=f(()=>e.getters["game/isGameFinished"]),w=f(()=>e.getters["game/isGameReady"]);f(()=>e.getters["game/shots"]),f(()=>e.getters["game/damage"]);const x=B=>e.commit("game/setIsGameStart",B),$=()=>e.commit("game/resetStateGame"),M=()=>e.commit("game/increaseShoots"),D=()=>e.commit("game/increaseDamage"),A=()=>e.commit("leaderBoard/resetStateLeaderBoard"),E=()=>{d.value+=1},b=()=>{A(),$(),E(),n.destroy(),s.destroy()},N=()=>{i.value=i},z=()=>{!w.value||L.value||(x(!0),M(),s.replay())},V=B=>{var R;if(!((R=_==null?void 0:_.value)!=null&&R.shooter))return;const I=_.value.shooter;c.value={x1:B.clientX,y1:I.getBoundingClientRect().top,x2:B.clientX+I.offsetWidth}},K=B=>{let I;window.addEventListener("resize",()=>{clearTimeout(I),I=setTimeout(()=>{b()},300)})};return Z(()=>{s=new Y(Ot,.3),n=new Y(At,.5,!0),K()}),ee(()=>{b()}),C(()=>w.value,()=>{n.replay()}),C(()=>L.value,()=>{n.pause()}),(B,I)=>{const R=Ne,X=Je,j=xt,W=Lt,T=Yt;return h(),p("div",{class:"main-game",onClick:z,onMousemove:V,key:g(d)},[y(R,{isDebug:g(o),barrier:g(i),shooter:g(c),onCanvasLettersDamage:D},null,8,["isDebug","barrier","shooter"]),y(X,{"onButtonPlay-Mounted":N,"onButtonPlay-Restart":b}),y(j),y(W,{position:g(c),ref_key:"shooter",ref:_},null,8,["position"]),y(T)],32)}}};const Nt={},Vt={class:"page-game"};function Kt(t,e){const s=Et;return h(),p("div",Vt,[y(s)])}const Wt=G(Nt,[["render",Kt]]);export{Wt as default};
